# Hubbub: CodeSnippet

Capturing microphone audio frequencies.

## Device Specifications

- MacBookPro
  - OS: High Sierra
  - Processor: 2.8 GHz Intel Core i7

## Browser Specifications

- Google Chrome
  - Version 75.0.3770.142 (Official Build) (64-bit)

## Capturing User Media (Audio)

### Components

- [[getUserMedia](https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia)]:Â Used to request access to users microphone.

  [Can I Use](https://caniuse.com/#feat=stream) Supported by __92.79%__ of browsers.

- [[AudioContext](https://developer.mozilla.org/en-US/docs/Web/API/AudioContext)]: Used to process user audio stream and generate frequency distribution.

  [Can I Use](https://caniuse.com/#search=AudioContext) Supported by __94.04%__ of browsers.

- [[Uint8Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array)]: Used to capture frequency distribution generated by __AudioContext__.

  [Can I Use](https://caniuse.com/#search=Uint8Array) Supported by __91%__ of browsers.

## Full Code Snippet

``` javascript
        function onStreamReady(stream) {
            let audioContext = new AudioContext();
            let source = audioContext.createMediaStreamSource(stream);
            let analyser = audioContext.createAnalyser();

            let processor = audioContext.createScriptProcessor(2048, 1, 1);

            analyser.fftSize = 2048;
            // [userMedia] -> [audioContext.destination]
            //                    ^
            //                  /
            //              [processor] -> [analyser] -> [Uint8Array]
            source.connect(analyser);
            analyser.connect(processor);


            source.connect(audioContext.destination);
            processor.connect(audioContext.destination);

            processor.onAudioProcess = function() {
                // REVIEW: I used a Uint8 primarily because a few tutorials I saw used it
                // too. I'm not sure if we want negative values but a Unsigned Int won't capture
                // negative values.
                let frequencyArray = new Uint8Array(analyser.frequencyBinCount);
                analyser.getByteFrequencyData(frequencyArray);
                // Do something with frequencyArray
            }
        }
```
